<!DOCTYPE HTML>
<html>
<head>
<title>FileExist()</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>FileExist(FilePattern)</h1>

<p>检查文件或目录是否存在并返回它的属性.</p>

<pre class="Syntax">AttributeString := FileExist(FilePattern)</pre>
<h3>参数</h3>
<dl>

  <dt>FilePattern</dt>
  <dd><p>要检查的 路径,文件名,或文件模式(文件模式指类似 "*.txt" 这样的 Dos 表示法). <em>FilePattern</em> 如果未指定完整路径,则假定在 <a href="../Variables.htm#WorkingDir">%A_WorkingDir%</a> 中.</p></dd>

</dl>

<h3>返回值</h3>
<p>函数返回找到第一个符合条件的文件或目录的属性字符串 ("RASHNDOCT" 中的一个或多个字母):</p>
<p>
R = READONLY (只读)<br>
A = ARCHIVE (存档)<br>
S = SYSTEM (系统)<br>
H = HIDDEN (隐藏)<br>
N = NORMAL (普通)<br>
D = DIRECTORY (目录)<br>
O = OFFLINE (离线)<br>
C = COMPRESSED (压缩)<br>
T = TEMPORARY (临时)<br>X = NONE (无属性)
</p>
<p>如果文件没有任何属性 (罕见), 则返回 "X". 如果文件不存在则返回空字符串.</p>

<h3>备注</h3>
<p>本函数相当于 <a href="IfExist.htm">IfExist</a> 和 <a href="FileGetAttrib.htm">FileGetAttrib</a> 的组合.</p>
<p>由于空字符串相当于 &quot;false&quot;, 函数的返回值总可以用于直接作为逻辑判断. 例如, 语句 <code>if FileExist(&quot;C:\My File.txt&quot;)</code> 如果文件存在则返回真,否则为假. 类似的, 语句 <code>if InStr(FileExist(&quot;C:\My Folder&quot;), &quot;D&quot;)</code> 当路径存在 <em>并且</em> 为目录时返回真.</p>

<h3>相关</h3>
<p><a href="IfExist.htm">IfExist</a>, <a href="FileGetAttrib.htm">FileGetAttrib</a>, <a href="Block.htm">Blocks</a>, <a href="Else.htm">Else</a>, <a href="LoopFile.htm">File-loops (文件循环)</a></p>
<h3>示例</h3>
<pre class="NoIndent">if FileExist("D:\")
    MsgBox, 驱动器存在.
if FileExist("D:\Docs\*.txt")
    MsgBox, 至少有一个 .txt 文件存在.
if !FileExist("C:\Temp\FlagFile.txt")
    MsgBox, 目标文件不存在.</pre>

<pre class="NoIndent"><em>; 下面的例子展示如何检查文件的指定属性:</em>
if InStr(FileExist("C:\My File.txt"), "H")
    MsgBox 文件是隐藏的.</pre>

</body>
</html>
