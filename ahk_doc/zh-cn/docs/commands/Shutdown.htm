<!DOCTYPE HTML>
<html>
<head>
<title>Shutdown</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>Shutdown</h1>

<p>关闭,重启或注销系统.</p>

<pre class="Syntax">Shutdown, Code</pre>
<h3>参数</h3>
<dl>

  <dt>Code</dt>
  <dd><p>在下面列出的关闭代码的组合.</p></dd>

</dl>

<h3>备注</h3>
<p>关闭代码包含下列值:</p>
<table class="info" style="width:80%">
  <tr>
   <td style="width:25%">logoff</td>
    <td>0</td>
  </tr>
  <tr>
    <td>Shutdown</td>
    <td>1</td>
  </tr>
  <tr>
    <td>重启</td>
    <td>2</td>
  </tr>
  <tr>
    <td>强制</td>
    <td>4</td>
  </tr>
  <tr>
    <td>断电</td>
    <td>8</td>
  </tr>
  <tr>
    <td>挂起/休眠</td>
    <td>请参阅本页底部的 <a href="#Suspend">DllCall 示例</a>.</td>
  </tr>
  <tr>
    <td>关闭显示器</td>
    <td>请参阅 <a href="PostMessage.htm#Examples">PostMessage 示例</a>.</td>
  </tr>
</table>
<p>把需要的值加在一起. 例如, 要关闭并切断电源的代码为 <strong>9</strong> (关闭 + 切断电源 = 1 + 8 = 9). 或者, 可以使用 <a href="../Variables.htm#Expressions">表达式</a>, 例如 1+8.</p>
<p>使用 "强制" 值 (4) 来强制关闭所有打开的应用程序. 它应该仅用于紧急的情况中, 因为这样可能导致打开的应用程序数据丢失.</p>
<p>"断电" 数值表示关闭系统并切断电源.</p>
<p>相关提示, 脚本通过 <a href="OnExit.htm">OnExit</a> 可以检测到系统正在关闭或用户正在注销.</p>
<h3>相关</h3>
<p><a href="Run.htm">Run</a>, <a href="ExitApp.htm">ExitApp</a>, <a href="OnExit.htm">OnExit</a></p>
<h3>示例</h3>
<pre class="NoIndent"><em>; 强制重新启动 (重启 + 强制 = 2 + 4 = 6):</em>
Shutdown, 6

<em id="Suspend">; 调用 Windows API 函数 "SetSuspendState" 来让系统挂起或休眠.
; 参数 #1: 使用 1 代替 0 来进行休眠而不是挂起.
; 参数 #2: 使用 1 代替 0 来立即挂起而不询问每个应用程序以获得许可.
; 参数 #3: 使用 1 而不是 0 来禁止所有的唤醒事件.</em>
DllCall("PowrProf\SetSuspendState", "int", 0, "int", 0, "int", 0)</pre>

</body>
</html>
